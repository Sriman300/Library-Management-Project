<div class="w-[99vw] min-h-[95vh] mx-auto p-4 md:p-8 bg-gray-50 rounded-3xl shadow-2xl border-2 border-gray-200 flex flex-col">

  <div class="flex flex-wrap items-center justify-between mb-8 gap-4 px-2">
    <div>
      <h1 class="text-4xl font-extrabold text-purple-700 tracking-tight">Student Profile</h1>
      <p class="text-base text-gray-600 font-medium">Personal details and Borrowed books</p>
    </div>

    <a href="/profiles" data-link
      class="inline-flex items-center gap-3 px-8 py-3 rounded-xl bg-blue-600 text-white text-sm font-bold hover:bg-blue-700 transition-all shadow-lg">
      ← Back to Directory
    </a>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-5 gap-8 flex-grow">

    <div class="lg:col-span-2 bg-white rounded-2xl shadow-sm border border-gray-200 flex flex-col overflow-hidden">
      <div class="p-6 border-b bg-gray-50/50">
        <h2 class="font-bold text-2xl text-purple-700">Basic Details</h2>
        <p class="text-sm text-gray-500 font-semibold">Student information</p>
      </div>

      <div class="p-8 space-y-6 flex-grow">
        <div id="basicLoading" class="text-center py-20">
          <div class="animate-spin rounded-full h-15 w-15 border-b-4 border-purple-500 mx-auto"></div>
          <p class="text-sm text-gray-500 mt-2">Loading student info...</p>
        </div>

        <div id="basicDetails" class="hidden grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="border-2 border-purple-50 rounded-2xl p-6 bg-purple-50/50">
            <div class="text-xs text-purple-700">Student ID</div>
            <div class="font-semibold text-gray-900 text-xl" id="studentId">—</div>
          </div>

          <div class="border-2 border-purple-50 rounded-2xl p-6 bg-purple-50/50">
            <div class="text-xs text-purple-700">Name</div>
            <div class="font-semibold text-gray-900 text-xl" id="studentName">—</div>
          </div>

          <div class="border-2 border-purple-50 rounded-2xl p-6 bg-purple-50/50 col-span-1 md:col-span-2">
            <div class="text-xs text-purple-700">Email</div>
            <div class="font-semibold text-gray-900 text-lg break-all" id="studentEmail">—</div>
          </div>

          <div class="border-2 border-purple-50 rounded-2xl p-6 bg-purple-50/50">
            <div class="text-xs text-purple-700">Phone</div>
            <div class="font-semibold text-gray-900 text-xl" id="studentPhone">—</div>
          </div>

          <div class="col-span-1 md:col-span-2 mt-4 bg-purple-100 border border-purple-200 rounded-3xl p-10 text-center">
            <div class="font-semibold text-purple-700">TotalBooksBorrowed</div>
            <div class="text-purple-900 font-bold text-7xl">
              <span id="totalBooksBorrowed">0</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="lg:col-span-3 bg-white rounded-2xl shadow-sm border border-gray-200 flex flex-col overflow-hidden">
      <div class="p-6 border-b flex flex-wrap items-center justify-between gap-6 bg-gray-50/50">
        <div>
          <h2 class="font-semibold text-2xl text-purple-700">TotalBooksBorrowed</h2>
          <p class="text-sm text-gray-500 mt-1">
            Book Title + ISBN + Cost + Author + Librarian Name + Student Name + Phone + Email
          </p>
        </div>

        <div class="flex gap-4">
          <button id="profileExportCsvBtn"
            class="px-8 py-3 text-sm border rounded-xl bg-white hover:bg-gray-100 transition-all">
            Export CSV
          </button>

          <button id="profileExportPdfBtn"
            class="px-8 py-3 text-sm border rounded-xl bg-white hover:bg-gray-100 transition-all">
            Export PDF
          </button>
        </div>
      </div>

      <div class="p-6 flex-grow flex flex-col">
        <div id="joinLoading" class="text-center py-40">
          <div class="animate-spin rounded-full h-8 w-8 border-b-4 border-purple-500 mx-auto"></div>
          <p class="text-sm text-gray-500 mt-2">Loading...</p>
        </div>

        <div id="joinTableContainer" class="hidden overflow-x-auto rounded-2xl border border-gray-200 flex-grow">
          <table class="min-w-full text-left border-collapse">
            <thead class="bg-gray-100 sticky top-0 z-10">
              <tr class="text-gray-700 whitespace-nowrap">
                <th class="px-5 py-6">Borrow ID</th>
                <th class="px-5 py-6">Book ID</th>  
                <th class="px-5 py-6">Book Title</th>
                <th class="px-5 py-6">Book Author</th>
                <th class="px-5 py-6">Book ISBN</th>
                <th class="px-5 py-6">Book Cost</th>
                <th class="px-5 py-6">Librarian Id</th>
                <th class="px-5 py-6">Librarian Name</th>
                <th class="px-5 py-6">Student ID</th>
                <th class="px-5 py-6">Student Name</th>
                <th class="px-5 py-6">Student Phone</th>
                <th class="px-5 py-6">Student Email</th>
              </tr>
            </thead>
            <tbody id="joinTableBody" class="divide-y divide-gray-50 bg-white"></tbody>
          </table>

          <p id="noBooksBorrowed" class="text-center text-gray-500 mt-10 py-20 hidden">
            This student has not borrowed any book.
          </p>
        </div>
      </div>
    </div>
  </div>

  <div id="alertContainer" class="fixed top-4 right-4 space-y-2 z-50"></div>
</div>